<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Form</title>
</head>
<body>
    <section class="Form-Content">
        <div class="Banner"><img src="assets/Banner.jpg" alt=""></div>
        <div class="toggle-form">
            <button onclick="toggleButtons()" id="button1"><img src="assets/menu.png"></button>
            <button onclick="toggleButtons()" id="button2" style="display: none;"><img src="assets/close.png"></button>
            <div class="nav-form" id="nav-form" style="display: none;">
                <ul>
                    <hr>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="Meeting.html">Meeting Information</a></li>
                    <li><a href="schedule.html">Abstract</a></li>
                    <li><a href="Speakers.html">Speakers</a></li>
                    <li><a href="Form.html">Registration</a></li>
                    <hr>
                </ul>
            </div>
        </div>
        <h1>Registration Form</h1>
        <hr id="form-line">
        <div class="form-container">
            <form name="email_sub">
                <label for="name">Name</label>
                <input type="text" name="name" required>

                <label for="email">Email</label>
                <input type="text" name="email" required>

                <label for="contact">Contact</label>
                <input type="text" name="contact">

                <label for="company">Organization/Company</label>
                <input type="text" name="company" required>

                <label for="registration_type">Register as</label>
                <select id="registration_type" name="registration_type" onchange="toggleAbstract()">
                    <option value="attendee">Attendee</option>
                    <option value="speaker">Speaker</option>
                </select>

                <label for="abstract" id="abstract_label" style="display:none;">Abstract</label>
                <textarea name="abstract" id="abstract" cols="30" rows="10" placeholder="Type or Copy your Abstract here....." style="display:none;"></textarea>
                <br>
                <input type="submit" name="" id="submit">
            </form>
        </div>
    </section>

    <script>
        function toggleButtons() {
            var button1 = document.getElementById('button1');
            var button2 = document.getElementById('button2');
            var navForm = document.getElementById('nav-form');

            if (button1.style.display !== 'none') {
                // Button 1 is visible, hide it and show Button 2 and nav-form
                button1.style.display = 'none';
                button2.style.display = 'block';
                navForm.style.display = 'block';
            } else {
                // Button 2 and nav-form are visible, hide them and show Button 1
                button1.style.display = 'block';
                button2.style.display = 'none';
                navForm.style.display = 'none';
            }
        }
        function toggleAbstract() {
            var registrationType = document.getElementById('registration_type').value;
            var abstractLabel = document.getElementById('abstract_label');
            var abstractTextarea = document.getElementById('abstract');

            if (registrationType === 'speaker') {
                abstractLabel.style.display = 'block';
                abstractTextarea.style.display = 'block';
                abstractTextarea.setAttribute('required', 'required');
            } else {
                abstractLabel.style.display = 'none';
                abstractTextarea.style.display = 'none';
                abstractTextarea.removeAttribute('required', 'required');
            }
        }
        const scriptURL = 'https://script.google.com/macros/s/AKfycbxBTKgMxAoSTvb7VfP_59LrTJXQs6p2xwlpUnjcpOB2F4RkJ4pvUpmFFVNJBxQ-6IJs/exec'
        const form = document.forms['email_sub']
        form.addEventListener('submit', e => {
            var button=document.getElementById('submit');
            button.style.backgroundColor="red";
            button.style.border = "1px solid black";
          e.preventDefault();
          fetch(scriptURL, { method: 'POST', body: new FormData(form)})
            .then(res => {
                // window.location.href = "index.html";
                alert('Form Submitted')
                location.reload();
          })
            .catch(error => {
              console.error('Error!', error.message);
              alert('Error : submission unsuccesfull \n Try again.....');
            })
            .then( a => (form.reset()));
        })
    </script>
</body>
</html>